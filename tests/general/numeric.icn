record array(a,b,c,d,e,f,g)

procedure p1()
   write("integer(2) ----> ",image(integer(2)) | "none")
   write("integer(\"2\") ----> ",image(integer("2")) | "none")
   write("integer(\" 2\") ----> ",image(integer(" 2")) | "none")
   write("integer(\"2 \") ----> ",image(integer("2 ")) | "none")
   write("integer(\"+2\") ----> ",image(integer("+2")) | "none")
   write("integer(\"-2\") ----> ",image(integer("-2")) | "none")
   write("integer(\"- 2\") ----> ",image(integer("- 2")) | "none")
   write("integer(\" -    2 \") ----> ",image(integer(" -    2 ")) | "none")
   write("integer(\"\") ----> ",image(integer("")) | "none")
end

procedure p2()
   write("integer(\"--2\") ----> ",image(integer("--2")) | "none")
   write("integer(\" \") ----> ",image(integer(" ")) | "none")
   write("integer(\"-\") ----> ",image(integer("-")) | "none")
   write("integer(\"+\") ----> ",image(integer("+")) | "none")
   write("integer(\"7r4\") ----> ",image(integer("7r4")) | "none")
end

procedure p3()
   write("integer(\"4r7\") ----> ",image(integer("4r7")) | "none")
   write("integer(\"4r 7\") ----> ",image(integer("4r 7")) | "none")
   write("integer(\"7r 4\") ----> ",image(integer("7r 4")) | "none")
   write("integer(\"16rff\") ----> ",image(integer("16rff")) | "none")
   write("integer(\"36rcat\") ----> ",image(integer("36rcat")) | "none")
   write("integer(\"36Rcat\") ----> ",image(integer("36Rcat")) | "none")
   write("integer(\"36rCAT\") ----> ",image(integer("36rCAT")) | "none")
   write("integer(\"1r1\") ----> ",image(integer("1r1")) | "none")
   write("integer(\"2r0\") ----> ",image(integer("2r0")) | "none")
   write("integer(integer) ----> ",image(integer(integer)) | "none")
   write("integer := abs ----> ",image(integer := abs) | "none")
end

procedure p4()
   write("numeric(2) ----> ",image(numeric(2)) | "none")
   write("numeric(\"2\") ----> ",image(numeric("2")) | "none")
   write("numeric(\" 2\") ----> ",image(numeric(" 2")) | "none")
   write("numeric(\"2 \") ----> ",image(numeric("2 ")) | "none")
   write("numeric(\"+2\") ----> ",image(numeric("+2")) | "none")
   write("numeric(\"-2\") ----> ",image(numeric("-2")) | "none")
   write("numeric(\"- 2\") ----> ",image(numeric("- 2")) | "none")
   write("numeric(\" -    2 \") ----> ",image(numeric(" -    2 ")) | "none")
   write("numeric(\"\") ----> ",image(numeric("")) | "none")
end

procedure p5()
   write("numeric(\"--2\") ----> ",image(numeric("--2")) | "none")
   write("numeric(\" \") ----> ",image(numeric(" ")) | "none")
   write("numeric(\"-\") ----> ",image(numeric("-")) | "none")
   write("numeric(\"+\") ----> ",image(numeric("+")) | "none")
   write("numeric(\"7r4\") ----> ",image(numeric("7r4")) | "none")
end

procedure p6()
   write("numeric(\"4r7\") ----> ",image(numeric("4r7")) | "none")
   write("numeric(\"4r 7\") ----> ",image(numeric("4r 7")) | "none")
   write("numeric(\"7r 4\") ----> ",image(numeric("7r 4")) | "none")
   write("numeric(\"16rff\") ----> ",image(numeric("16rff")) | "none")
   write("numeric(\"36rcat\") ----> ",image(numeric("36rcat")) | "none")
   write("numeric(\"36Rcat\") ----> ",image(numeric("36Rcat")) | "none")
   write("numeric(\"36rCAT\") ----> ",image(numeric("36rCAT")) | "none")
   write("numeric(\"1r1\") ----> ",image(numeric("1r1")) | "none")
   write("numeric(\"2r0\") ----> ",image(numeric("2r0")) | "none")
end

procedure p9()
   write("100 - - 4 ----> ",image(100 - - 4) | "none")
   write("100 --4 ----> ",image(100 --4) | "none")
   write("100- - 4 ----> ",image(100- - 4) | "none")
   write("100 -- 4 ----> ",image(100 -- 4) | "none")
   write("100 - -4 ----> ",image(100 - -4) | "none")
end

procedure p10()
   write("abs(1) ----> ",image(abs(1)) | "none")
   write("abs(-1) ----> ",image(abs(-1)) | "none")
   write("abs(0) ----> ",image(abs(0)) | "none")
   write("36 % 7 ----> ",image(36 % 7) | "none")
   write("-36 % 7 ----> ",image(-36 % 7) | "none")
   write("36 % -7 ----> ",image(36 % -7) | "none")
   write("-36 % -7 ----> ",image(-36 % -7) | "none")
end

procedure p11()
   write("36 * 9 ----> ",image(36 * 9) | "none")
   write("-36 * 9 ----> ",image(-36 * 9) | "none")
   write("36 * -9 ----> ",image(36 * -9) | "none")
   write("-36 * -9 ----> ",image(-36 * -9) | "none")
end

procedure p12()
   write("36 / 9 ----> ",image(36 / 9) | "none")
   write("-36 / 9 ----> ",image(-36 / 9) | "none")
   write("36 / -9 ----> ",image(36 / -9) | "none")
   write("-36 / -9 ----> ",image(-36 / -9) | "none")
end

procedure p13()
   write("36 + 9 ----> ",image(36 + 9) | "none")
   write("-36 + 9 ----> ",image(-36 + 9) | "none")
   write("36 + -9 ----> ",image(36 + -9) | "none")
   write("-36 + -9 ----> ",image(-36 + -9) | "none")
end

procedure p14()
   write("36 ^ -9 ----> ",image(36 ^ -9) | "none")
   write("1 < 1 ----> ",image(1 < 1) | "none")
   write("1 < 2 ----> ",image(1 < 2) | "none")
   write("1 < 0 ----> ",image(1 < 0) | "none")
   write("-1 < 0 ----> ",image(-1 < 0) | "none")
   write("1 < -2 ----> ",image(1 < -2) | "none")
   write("-1 < -0 ----> ",image(-1 < -0) | "none")
end

procedure p15()
   write("1 > 1 ----> ",image(1 > 1) | "none")
   write("1 > 2 ----> ",image(1 > 2) | "none")
   write("1 > 0 ----> ",image(1 > 0) | "none")
   write("-1 > 0 ----> ",image(-1 > 0) | "none")
   write("1 > -2 ----> ",image(1 > -2) | "none")
end

procedure p16()
   write("-1 > -0 ----> ",image(-1 > -0) | "none")
   write("1 <= 1 ----> ",image(1 <= 1) | "none")
   write("1 <= 2 ----> ",image(1 <= 2) | "none")
   write("1 <= 0 ----> ",image(1 <= 0) | "none")
   write("-1 <= 0 ----> ",image(-1 <= 0) | "none")
end

procedure p17()
   write("1 <= -2 ----> ",image(1 <= -2) | "none")
   write("-1 <= -0 ----> ",image(-1 <= -0) | "none")
   write("1 >= 1 ----> ",image(1 >= 1) | "none")
   write("1 >= 2 ----> ",image(1 >= 2) | "none")
   write("1 >= 0 ----> ",image(1 >= 0) | "none")
end

procedure p18()
   write("-1 >= 0 ----> ",image(-1 >= 0) | "none")
   write("1 >= -2 ----> ",image(1 >= -2) | "none")
   write("-1 >= -0 ----> ",image(-1 >= -0) | "none")
   write("1 = 1 ----> ",image(1 = 1) | "none")
   write("1 = 2 ----> ",image(1 = 2) | "none")
end

procedure p19()
   write("1 = 0 ----> ",image(1 = 0) | "none")
   write("-1 = 0 ----> ",image(-1 = 0) | "none")
   write("1 = -2 ----> ",image(1 = -2) | "none")
   write("-1 = -0 ----> ",image(-1 = -0) | "none")
   write("1 ~= 1 ----> ",image(1 ~= 1) | "none")
end

procedure p20()
   write("1 ~= 2 ----> ",image(1 ~= 2) | "none")
   write("1 ~= 0 ----> ",image(1 ~= 0) | "none")
   write("-1 ~= 0 ----> ",image(-1 ~= 0) | "none")
   write("1 ~= -2 ----> ",image(1 ~= -2) | "none")
   write("-1 ~= -0 ----> ",image(-1 ~= -0) | "none")
end

procedure p21()
   write("36 ^ -9 ----> ",image(36 ^ -9) | "none")
   write("-36 ^ -9 ----> ",image(-36 ^ -9) | "none")
end

procedure p22()                 # Basic sanity check for suffixes
   write("1k ---> ",image(1k) | "none")
   write("1K ---> ",image(1K) | "none")
   write("1m ---> ",image(1m) | "none")
   write("1M ---> ",image(1M) | "none")
   write("1g ---> ",image(1g) | "none")
   write("1G ---> ",image(1G) | "none")
   write("1t ---> ",image(1t) | "none")
   write("1T ---> ",image(1T) | "none")
   write("1p ---> ",image(1p) | "none")
   write("1P ---> ",image(1P) | "none")
   write("-1k ---> ",image(-1k) | "none")
   write("-1K ---> ",image(-1K) | "none")
   write("-1m ---> ",image(-1m) | "none")
   write("-1M ---> ",image(-1M) | "none")
   write("-1g ---> ",image(-1g) | "none")
   write("-1G ---> ",image(-1G) | "none")
   write("-1t ---> ",image(-1t) | "none")
   write("-1T ---> ",image(-1T) | "none")
   write("-1p ---> ",image(-1p) | "none")
   write("-1P ---> ",image(-1P) | "none")
end

procedure p23()                 # whitespace not allowed between number and suffix
   write("numeric(\"1 k\") ---> ",image(numeric("1 k")) | "none")
   write("numeric(\"1\\tm\") ---> ",image(numeric("1\tm")) | "none")
   write("numeric(\"1\\ng\") ---> ",image(numeric("1\ng")) | "none")
   write("numeric(\"1\\t t\") ---> ",image(numeric("1\t t")) | "none")
   write("numeric(\"1 p\") ---> ",image(numeric("1 p")) | "none")
end

procedure p24()                 # leading and trailing whitespace is allowed
   write("numeric(\"   1k \") ---> ",image(numeric("   1k ")) | "none")
   write("numeric(\"  \\t1m    \") ---> ",image(numeric("  \t1m    ")) | "none")
   write("numeric(\"1g\\t\") ---> ",image(numeric("1g\t")) | "none")
   write("numeric(\"1t \\t \") ---> ",image(numeric("1t \t ")) | "none")
   write("numeric(\"\\n\\r1p\\t\\n\\t\\r \") ---> ",image(numeric("\n1p\t\n\t\r")) | "none")
end

procedure p25()                 # Check every suffix letter
   every s := !&letters do {
      write("numeric(1" || s || ") ---> ", image(numeric(1 || s)) | "none")
      write("numeric(-1" || s || ") ---> ", image(numeric(-1 || s)) | "none")
   }
end

procedure p26()                 # check multiples
   write("1024k=1m ---> ",(1024k=1m) | "none")
   write("1024m=1g ---> ",(1024m=1g) | "none")
   write("1024g=1t ---> ",(1024g=1t) | "none")
   write("1024t=1p ---> ",(1024t=1p) | "none")
end

procedure p27()                 # Real numbers can't have a suffix
   write("numeric(\"1.0k\") ---> ",numeric("1.0k") | "none")
   write("numeric(\"1.5m\") ---> ",numeric("1.5m") | "none")
   write("numeric(\"1e-6t\") ---> ",numeric("1e-6t") | "none")
   write("numeric(\"-1.5e999t\") ---> ",numeric("-1.5e999t") | "none")
   write("numeric(\"-1e-1m\") ---> ",numeric("-1e-1m") | "none")
end

procedure p28()                 # Check big numbers (assuming 64-bit "small" integers)
   # 2^60  = 1,152,921,504,606,846,976
   # 2^70  = 1,180,591,620,717,411,303,424
   # 2^80  = 1,208,925,819,614,629,174,706,176
   # 2^90  = 1,237,940,039,285,380,274,899,124,224
   # 2^100 = 1,267,650,600,228,229,401,496,703,205,376
   write("(2^60)K = 2^70 ---> ",
         (numeric("1152921504606846976K") = 1180591620717411303424) | "none")
   write("(2^60)M = 2^80 ---> ",
         (numeric("1152921504606846976M") = 1208925819614629174706176) | "none")
   write("(2^70)K = 2^80 ---> ",
         (numeric("1180591620717411303424K") = 1208925819614629174706176) | "none")
   write("(2^70)G = 2^100 ---> ",
         (numeric("1180591620717411303424G") = 1267650600228229401496703205376) | "none")
end

procedure p29()                 # Check around 16, 32, 48, 64 bit boundaries
   # 2^14 = 16,384          2^31 = 2,147,483,648            2^54 = 18,014,398,509,481,984
   # 2^15 = 32,768          2^32 = 4,294,967,296            2^55 = 36,028,797,018,963,968
   # 2^16 = 65,536          2^33 = 8,589,934,592            2^60 = 1,152,921,504,606,846,976
   # 2^17 = 131,072         2^46 = 70,368,744,177,664       2^61 = 2,305,843,009,213,693,952
   # 2^20 = 1,048,576       2^47 = 140,737,488,355,328      2^62 = 4,611,686,018,427,387,904
   # 2^21 = 2,097,152       2^48 = 281,474,976,710,656      2^63 = 9,223,372,036,854,775,808
   # 2^22 = 4,194,304       2^49 = 562,949,953,421,312      2^64 = 18,446,744,073,709,551,616
   # 2^23 = 8,388,608       2^52 = 4,503,599,627,370,496    2^65 = 36,893,488,147,419,103,232
   # 2^30 = 1,073,741,824   2^53 = 9,007,199,254,740,992

   write("(2^4)K = 2^14 ---> ", (numeric("16K") = 16384) | "none")
   write("(2^5)K = 2^15 ---> ", (numeric("32K") = 32768) | "none")
   write("(2^6)K = 2^16 ---> ", (numeric("64K") = 65536) | "none")
   write("(2^7)K = 2^17 ---> ", (numeric("128K") = 131072) | "none")

   write("(2^20)K = 2^30 ---> ", (numeric("1048576K") = 1073741824) | "none")
   write("(2^21)K = 2^31 ---> ", (numeric("2097152K") = 2147483648) | "none")
   write("(2^22)K = 2^32 ---> ", (numeric("4194304K") = 4294967296) | "none")
   write("(2^23)K = 2^33 ---> ", (numeric("8388608K") = 8589934592) | "none")

   write("(2^36)K = 2^46 ---> ", (numeric("68719476736K")  = 70368744177664)  | "none")
   write("(2^37)K = 2^47 ---> ", (numeric("137438953472K") = 140737488355328) | "none")
   write("(2^38)K = 2^48 ---> ", (numeric("274877906944K") = 281474976710656) | "none")
   write("(2^39)K = 2^49 ---> ", (numeric("549755813888K") = 562949953421312) | "none")

   write("(2^52)K = 2^62 ---> ", (numeric("4503599627370496K") = 4611686018427387904) | "none")
   write("(2^53)K = 2^63 ---> ", (numeric("9007199254740992K") = 9223372036854775808) | "none")
   write("(2^54)K = 2^64 ---> ", (numeric("18014398509481984K") = 18446744073709551616) | "none")
   write("(2^55)K = 2^65 ---> ", (numeric("36028797018963968K") = 36893488147419103232) | "none")
end

procedure main()
   p1()
   p2()
   p3()
   p4()
   p5()
   p6()
   p9()
   p10()
   p11()
   p12()
   p13()
   p14()
   p15()
   p16()
   p17()
   p18()
   p19()
   p20()
   p21()
   p22()
   p23()
   p24()
   p25()
   p26()
   p27()
   p28()
   p29()
end

